var bsearch=function(){function r(r,n,t,e,a){var i=["function ",r,"(a,l,h,",e.join(","),"){",a?"":"var i=",t?"l-1":"h+1",";while(l<=h){      var m=(l+h)>>>1,x=a[m]"];return a?n.indexOf("c")<0?i.push(";if(x===y){return m}else if(x<=y){"):i.push(";var p=c(x,y);if(p===0){return m}else if(p<=0){"):i.push(";if(",n,"){i=m;"),t?i.push("l=m+1}else{h=m-1}"):i.push("h=m-1}else{l=m+1}"),i.push("}"),a?i.push("return -1};"):i.push("return i};"),i.join("")}function n(n,t,e,a){return new Function([r("A","x"+n+"y",t,["y"],a),r("P","c(x,y)"+n+"0",t,["y","c"],a),"function dispatchBsearch",e,"(a,y,c,l,h){if(typeof(c)==='function'){return P(a,(l===void 0)?0:l|0,(h===void 0)?a.length-1:h|0,y,c)}else{return A(a,(c===void 0)?0:c|0,(l===void 0)?a.length-1:l|0,y)}}return dispatchBsearch",e].join(""))()}return{ge:n(">=",!1,"GE"),gt:n(">",!1,"GT"),lt:n("<",!0,"LT"),le:n("<=",!0,"LE"),eq:n("-",!0,"EQ",!0)}}(),createTriangulation=function(){function r(r,n){this.stars=r,this.edges=n}var n=r.prototype;function t(r,n,t){for(var e=1,a=r.length;e<a;e+=2)if(r[e-1]===n&&r[e]===t)return r[e-1]=r[a-2],r[e]=r[a-1],void(r.length=a-2)}return n.isConstraint=function(){var r=[0,0];function n(r,n){return r[0]-n[0]||r[1]-n[1]}return function(t,e){return r[0]=Math.min(t,e),r[1]=Math.max(t,e),bsearch.eq(this.edges,r,n)>=0}}(),n.removeTriangle=function(r,n,e){var a=this.stars;t(a[r],n,e),t(a[n],e,r),t(a[e],r,n)},n.addTriangle=function(r,n,t){var e=this.stars;e[r].push(n,t),e[n].push(t,r),e[t].push(r,n)},n.opposite=function(r,n){for(var t=this.stars[n],e=1,a=t.length;e<a;e+=2)if(t[e]===r)return t[e-1];return-1},n.flip=function(r,n){var t=this.opposite(r,n),e=this.opposite(n,r);this.removeTriangle(r,n,t),this.removeTriangle(n,r,e),this.addTriangle(r,e,t),this.addTriangle(n,t,e)},n.edges=function(){var r=this.stars,n=[];return r.forEach(function(r){for(var t=0,e=r.length;t<e;t+=2)n.push([r[t],r[t+1]])}),n},n.cells=function(){var r=this.stars,n=[];return r.forEach(function(r,t){for(var e=0,a=r.length;e<a;e+=2){var i=r[e],u=r[e+1];t<i&&t<u&&n.push([t,i,u])}}),n},function(n,t){for(var e=new Array(n),a=0;a<n;++a)e[a]=[];return new r(e,t)}}(),monotone=function(){function r(r,n,t){return(n[0]-t[0])*(r[1]-t[1])-(n[1]-t[1])*(r[0]-t[0])}var n=0;function t(r,n,t,e,a){this.a=r,this.b=n,this.idx=t,this.lowerIds=e,this.upperIds=a}function e(r,n,t,e){this.a=r,this.b=n,this.type=t,this.idx=e}function a(t,e){var a=t.a[0]-e.a[0]||t.a[1]-e.a[1]||t.type-e.type;return a||(t.type!==n&&(a=r(t.a,t.b,e.b))?a:t.idx-e.idx)}function i(n,t){return r(n.a,n.b,t)}function u(n,t,e,a,u){for(var o=bsearch.lt(t,a,i),s=bsearch.gt(t,a,i),h=o;h<s;++h){for(var c=t[h],f=c.lowerIds,l=f.length;l>1&&r(e[f[l-2]],e[f[l-1]],a)>0;)n.push([f[l-1],f[l-2],u]),l-=1;f.length=l,f.push(u);var p=c.upperIds;for(l=p.length;l>1&&r(e[p[l-2]],e[p[l-1]],a)<0;)n.push([p[l-2],p[l-1],u]),l-=1;p.length=l,p.push(u)}}function o(n,t){var e;return(e=n.a[0]<t.a[0]?r(n.a,n.b,t.a):r(t.b,t.a,n.a))?e:(e=t.b[0]<n.b[0]?r(n.a,n.b,t.b):r(t.b,t.a,n.b))||n.idx-t.idx}function s(r,n,e){var a=bsearch.le(r,e,o),i=r[a],u=i.upperIds,s=u[u.length-1];i.upperIds=[s],r.splice(a+1,0,new t(e.a,e.b,e.idx,[s],u))}function h(r,n,t){var e=t.a;t.a=t.b,t.b=e;var a=bsearch.eq(r,t,o),i=r[a];r[a-1].upperIds=i.upperIds,r.splice(a,1)}return function(r,i){r.length,i.length;var o=r.map(function(r,t){return new e(r,null,n,t)});i.forEach(function(n,t){var a=r[n[0]],i=r[n[1]];a[0]<i[0]?o.push(new e(a,i,2,t),new e(i,a,1,t)):a[0]>i[0]&&o.push(new e(i,a,2,t),new e(a,i,1,t))}),o.sort(a);for(var c=o[0].a[0]-(1+Math.abs(o[0].a[0]))*Math.pow(2,-52),f=[new t([c,1],[c,0],-1,[],[],[],[])],l=[],p=0,v=o.length;p<v;++p){var g=o[p],d=g.type;d===n?u(l,f,r,g.a,g.idx):2===d?s(f,0,g):h(f,0,g)}return l}}(),delaunayRefine=function(){function r(r,n){return r.x*n.y-r.y*n.x}function n(n,t,e,a){var i=[n,t,e].map(function(r){var n={x:r[0]-a[0],y:r[1]-a[1]};return n.r2=n.x*n.x+n.y*n.y,n});return i[0].r2*r(i[1],i[2])+i[1].r2*r(i[2],i[0])+i[2].r2*r(i[0],i[1])}function t(r,t,e,a,i,u){var o=t.opposite(a,i);if(!(o<0)){if(i<a){var s=a;a=i,i=s,s=u,u=o,o=s}t.isConstraint(a,i)||n(r[a],r[i],r[u],r[o])<0&&e.push(a,i)}}function e(r,a,i,u){var o=(u=u||{}).criteria||.125;o=Math.sqrt(1-o);u.size_criteria||a.length;var s=[],h=i.stars;h.forEach(function(r,t){for(var e=1;e<r.length;e+=2){var u=r[e];if(!(u<t)&&!i.isConstraint(t,u)){for(var o=r[e-1],h=-1,c=1;c<r.length;c+=2)if(r[c-1]===u){h=r[c];break}h<0||n(a[t],a[u],a[o],a[h])<0&&s.push(t,u)}}}),function(){for(;s.length>0;){for(var r=s.pop(),e=s.pop(),u=-1,o=-1,c=h[e],f=1;f<c.length;f+=2){var l=c[f-1],p=c[f];l===r?o=p:p===r&&(u=l)}u<0||o<0||n(a[e],a[r],a[u],a[o])>=0||(i.flip(e,r),t(a,i,s,u,e,o),t(a,i,s,e,o,u),t(a,i,s,o,r,u),t(a,i,s,r,u,o))}}(),r>0&&e(r-1,a,i,u)}return function(r,n,t){return e(0,r,n,t)}}(),classifyFaces=function(){function r(r,n,t,e,a,i,u){this.cells=r,this.neighbor=n,this.flags=e,this.constraint=t,this.active=a,this.next=i,this.boundary=u}var n;function t(r,n){return r[0]-n[0]||r[1]-n[1]||r[2]-n[2]}return r.prototype.locate=(n=[0,0,0],function(r,e,a){var i=r,u=e,o=a;return e<a?e<r&&(i=e,u=a,o=r):a<r&&(i=a,u=r,o=e),i<0?-1:(n[0]=i,n[1]=u,n[2]=o,bsearch.eq(this.cells,n,t))}),function(n,e,a){var i=function(n,e){for(var a=n.cells(),i=a.length,u=0;u<i;++u){var o=(y=a[u])[0],s=y[1],h=y[2];s<h?s<o&&(y[0]=s,y[1]=h,y[2]=o):h<o&&(y[0]=h,y[1]=o,y[2]=s)}a.sort(t);var c=new Array(i);for(u=0;u<c.length;++u)c[u]=0;var f=[],l=[],p=new Array(3*i),v=new Array(3*i),g=null;e&&(g=[]);var d=new r(a,p,v,c,f,l,g);for(u=0;u<i;++u)for(var y=a[u],b=0;b<3;++b){o=y[b],s=y[(b+1)%3];var x=p[3*u+b]=d.locate(s,o,n.opposite(s,o)),m=v[3*u+b]=n.isConstraint(o,s);x<0&&(m?l.push(u):(f.push(u),c[u]=1),e&&g.push([s,o,-1]))}return d}(n,a);if(0===e)return a?i.cells.concat(i.boundary):i.cells;for(var u=1,o=i.active,s=i.next,h=i.flags,c=i.cells,f=i.constraint,l=i.neighbor;o.length>0||s.length>0;){for(;o.length>0;){var p=o.pop();if(h[p]!==-u){h[p]=u,c[p];for(var v=0;v<3;++v){var g=l[3*p+v];g>=0&&0===h[g]&&(f[3*p+v]?s.push(g):(o.push(g),h[g]=u))}}}var d=s;s=o,o=d,s.length=0,u=-u}var y=function(r,n,t){for(var e=0,a=0;a<r.length;++a)n[a]===t&&(r[e++]=r[a]);return r.length=e,r}(c,h,e);return a?y.concat(i.boundary):y}}(),cdt2d=function(){function r(r){return[Math.min(r[0],r[1]),Math.max(r[0],r[1])]}function n(r,n){return r[0]-n[0]||r[1]-n[1]}return function(t,e,a){var i=monotone,u=createTriangulation,o=delaunayRefine,s=classifyFaces;if(Array.isArray(e)?(a=a||{},e=e||[]):(a=e||{},e=[]),0===t.length)return[];for(var h=i(t,e),c=u(t.length,function(t){return t.map(r).sort(n)}(e)),f=0;f<h.length;++f){var l=h[f];c.addTriangle(l[0],l[1],l[2])}return o(t,c,a),s(c,-1),c}}();